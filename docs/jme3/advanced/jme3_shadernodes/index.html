<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.50">
<script src="/js/dark_default.js"></script>

<title data-react-helmet="true">jme3_shadernodes | jMonkeyEngine Documentation</title>

<meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="jme3_shadernodes | jMonkeyEngine Documentation"><meta data-react-helmet="true" name="description" content="Motivations"><meta data-react-helmet="true" property="og:description" content="Motivations"><meta data-react-helmet="true" property="og:url" content="https://8keep.github.io/wikidemo/docs/jme3/advanced/jme3_shadernodes">

<link data-react-helmet="true" rel="shortcut icon" href="/wikidemoimg/favicon.ico">


<link rel="stylesheet" href="/wikidemostyles.7d008dc0.css">


<link rel="preload" href="/wikidemostyles.08ff7081.js" as="script">

<link rel="preload" href="/wikidemoruntime~main.aab3cf1b.js" as="script">

<link rel="preload" href="/wikidemomain.53cb7c94.js" as="script">

<link rel="preload" href="/wikidemo1.e501629b.js" as="script">

<link rel="preload" href="/wikidemo2.c824d386.js" as="script">

<link rel="preload" href="/wikidemo302.1d1a2997.js" as="script">

<link rel="preload" href="/wikidemo394d525a.30c299b8.js" as="script">

<link rel="preload" href="/wikidemo17896441.d065d5f5.js" as="script">

<link rel="preload" href="/wikidemoc394a4b7.005237dd.js" as="script">

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a aria-current="page" class="navbar__brand active" href="/wikidemo"><img class="navbar__logo" src="/wikidemoimg/iconx128.png" alt="JmonkeyEngine"><strong class="navbar__title"></strong></a><a class="navbar__item navbar__link" href="/wikidemodocs/documentation">Docs</a></div><div class="navbar__items navbar__items--right"><a target="_blank" rel="noopener noreferrer" href="https://github.com/8keep/wikidemo" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a aria-current="page" class="navbar__brand active" href="/wikidemo"><img class="navbar__logo" src="/wikidemoimg/iconx128.png" alt="JmonkeyEngine"><strong class="navbar__title"></strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/wikidemodocs/documentation">Docs</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://github.com/8keep/wikidemo" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><main class="docMainContainer_FFX1"><div class="padding-vert--lg"><div class="container"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">jme3_shadernodes</h1></header><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="motivations"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#motivations" title="Direct link to heading">#</a>Motivations</h1><p>jME3 material system is entirely based on shaders. While it&#x27;s pretty
powerful, this system has some issues and limitations :</p><ul><li><p>Monolithic shaders have a serious lack of flexibility, and it can be
daunting to get into the code for inexperienced users.</p></li><li><p>Maintenance ease of such shaders is poor. (for example the whole
lighting shaders represent around 500 lines of code, and it could be
a lot worse with more features)</p></li><li><p>Adding new features to those shaders decrease the ease of
maintenance a lot. This point made us reluctant to do so and some
feature were never added (Fog to name it, but many more).</p></li><li><p>Users can&#x27;t add their own feature to the shader unless they fork it,
and fall back to the same issues explained in previous points.</p></li></ul><p>Shader Nodes were designed with this in mind and are the fruit of many
long discussions in the core chat balancing the pros and cons of this or
that pattern.\
At first this system was referred to as &quot;Shader injection. The basic
idea was to allow users to inject code into shaders with a tag
replacement system.\
We finally came with a different concept called Shader Nodes, that is
inspired from blender nodes system for textures and post process.\
<strong>The final shader is generated at run time by the system by assembling
shader nodes together.</strong></p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="what-is-a-shader-node"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#what-is-a-shader-node" title="Direct link to heading">#</a>What is a Shader Node?</h1><p>Conceptually, it&#x27;s just a self sufficient piece of glsl code that
accepts inputs and produce some outputs.\
Inputs are glsl variables that may be fed by previous nodes output
values.\
Outputs are glsl variables fed with values computed in the shader node
code.\</p><p>In practice it&#x27;s a bit more than that.A shader node is declined in
several parts :</p><ul><li><p>A shader node definition, defining :</p><ul><li><p>The type of shader node (Vertex or Fragment for now)</p></li><li><p>The minimal glsl version needed for the shader node</p></li><li><p>The path to the shader file (containing the shader code heh)</p></li><li><p><strong>A mandatory documentation block</strong> for this Shader node. As I
hope many users will do their own nodes and contribute them back
this point is crucial.</p></li><li><p>A list of inputs accepted by this shader (typed glsl variable
optional or needed for the code to run properly)</p></li><li><p>A list of outputs produced by this shader (typed glsl variable
computed and fed by the node&#x27;s code)</p></li></ul></li><li><p>The actual shader code file (.vert or .frag depending on the node&#x27;s
type like any shader file)</p></li><li><p>A shader node declaration having :</p><ul><li><p>A unique name(in the shader scope)</p></li><li><p>The shader node definition it&#x27;s based on</p></li><li><p>An optional activation condition (based on the actual define
system)</p></li><li><p>A list of input mapping (what will be actually fed to those
inputs)</p></li><li><p>A list of output mapping (what will be output to the global
output of the shader)</p></li></ul></li></ul><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="shader-node-definition"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#shader-node-definition" title="Direct link to heading">#</a>Shader Node definition</h1><p>First ShaderNodes have to be defined either in a separate file (j3sn for
jme3 shader node) or directly embed in the Technique block of the j3md
file.\
Please refer to this documentation for global structure of a j3md file
<a href="/wikidemo/docs/jme3/advanced/material_specification">jMonkeyEngine3 Material
Specification</a></p><p>All is included in a <strong>ShaderNodeDefinitions</strong> bloc. This block can have
several nodes defined (it&#x27;s recommended to define nodes that have strong
dependencies with each other in the same j3sn file).\
A ShaderNode is declared in a <strong>ShaderNodeDefinition</strong> block.\
The global structure should look like this :</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token class-name">ShaderNodeDefinitions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token class-name">ShaderNodeDefinition</span><span class="token plain"> </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">NodeDefName</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">Type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">ShaderType</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">Shader</span><span class="token plain"> </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">ShaderLangAndVersion</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">ShaderPath</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">[</span><span class="token class-name">Shader</span><span class="token plain"> </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">ShaderLangAndVersion</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">ShaderPath</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">Documentation</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">DocContent</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">Input</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">GlslVarType</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">VarName</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">[</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">GlslVarType</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">VarName</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">Output</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">GlslVarType</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">VarName</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">[</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">GlslVarType</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">VarName</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token class-name">ShaderNodeDefinition</span><span class="token plain"> </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">NodeDef2Name</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div></div></div><p>All that is not between [] is mandatory.</p><ul><li><p>ShaderNodeDefinition : the definition block. You can have several
definition in the same ShaderNodeDefinitions block.</p><ul><li><strong>NodeDefName</strong> : The name of this ShaderNodeDefinition</li></ul></li><li><p>Type : define the type of this shader node</p><ul><li><strong>ShaderType</strong> : The type of shader for this definition. For now
only &quot;Vertex and &quot;Fragment are supported.</li></ul></li><li><p>Shader : the version and path of the shader code to use. note that
you can have several shader with different GLSL version. The
generator will pick the relevant one according to GPU capabilities.</p><ul><li><p><strong>ShaderLangAndVersion</strong> : follows the same syntax than the
shader declaration in the j3md file : GLSL\&lt;version&gt;, version
being 100 for glsl 1.0 , 130 for glsl 1.3, 150 for glsl 1.5 and
so on. Note that this is the <strong>minimum</strong> glsl version this
shader supports</p></li><li><p><strong>ShaderPath</strong> the path to the shader code file (relative to the
asset folder)</p></li></ul></li><li><p>Documentation : the documentation block. This is mandatory and I
really recommend filling this if you want to contribute your shader
nodes. This documentation will be read buy the SDK and presented to
users willing to add this node to their material definitions. This
should contain a brief description of the node and a description for
each input and ouput.</p><ul><li><p><strong>\@input</strong> can be use to prefix an input name so the sdk
recognize it and format it accordingly. the syntax id \@input
\&lt;inputName&gt; \&lt;description&gt;.</p></li><li><p><strong>\@output</strong> can be use to prefix an output name so the sdk
recognize it and format it accordingly. the syntax id \@output
\&lt;inputName&gt; \&lt;description&gt;</p></li></ul></li><li><p>Input : The input block containing all the inputs of this node. A
node can have 1 or several inputs.</p><ul><li><p><strong>GlslVarType</strong> : a valid glsl variable type that will be used
in the shader for this input. see
<a href="http://www.opengl.org/wiki/GLSL_Type">http://www.opengl.org/wiki/GLSL_Type</a> and the &quot;Declare an array
chapter</p></li><li><p><strong>VarName</strong> : the name of the variable. Note that you can&#x27;t have
several inputs with the same name.</p></li></ul></li><li><p>Output : The output block containing all the outputs of this node. A
node can have 1 or several outputs.</p><ul><li><p><strong>GlslVarType</strong> : a valid glsl variable type that will be used
in the shader for this input. see
<a href="http://www.opengl.org/wiki/GLSL_Type">http://www.opengl.org/wiki/GLSL_Type</a> and the &quot;Declare an array
chapter</p></li><li><p><strong>VarName</strong> : the name of the variable. Note that you can&#x27;t have
several outputs with the same name.</p></li></ul></li></ul><p>::: {.note}
If you use the same name for an input and an ouput, the generator will
consider them as the SAME variable so they should be of the same glsl
type.
:::</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="example"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#example" title="Direct link to heading">#</a>Example</h2><p>Here is a typical shader node definition.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token class-name">ShaderNodeDefinitions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token class-name">ShaderNodeDefinition</span><span class="token plain"> </span><span class="token class-name">LightMapping</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Fragment</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Shader</span><span class="token plain"> GLSL100</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Common</span><span class="token operator" style="color:#393A34">/</span><span class="token class-name">MatDefs</span><span class="token operator" style="color:#393A34">/</span><span class="token class-name">ShaderNodes</span><span class="token operator" style="color:#393A34">/</span><span class="token class-name">LightMapping</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">lightMap</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">frag</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Documentation</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">This</span><span class="token plain"> </span><span class="token class-name">Node</span><span class="token plain"> is responsible </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> multiplying a light mapping contribution </span><span class="token keyword" style="color:#00009f">to</span><span class="token plain"> a given color</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token annotation punctuation" style="color:#393A34">@input</span><span class="token plain"> texCoord the texture coordinates </span><span class="token keyword" style="color:#00009f">to</span><span class="token plain"> use </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> light mapping</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token annotation punctuation" style="color:#393A34">@input</span><span class="token plain"> lightMap the texture </span><span class="token keyword" style="color:#00009f">to</span><span class="token plain"> use </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> light mapping</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token annotation punctuation" style="color:#393A34">@input</span><span class="token plain"> color the color the lightmap color will be multiplied </span><span class="token keyword" style="color:#00009f">to</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token annotation punctuation" style="color:#393A34">@output</span><span class="token plain"> color the resulting color</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Input</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            vec2 texCoord</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            sampler2D lightMap</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            vec4 color</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Output</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            vec4 color</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="declare-an-array"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#declare-an-array" title="Direct link to heading">#</a>Declare an array</h2><p>To declare an array you have to specify its size between square
brackets.\
<strong>Constant size</strong>\
The size can be an int constant.\
<em>Example</em></p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">      float myArray[10]</span></div></div></div></div></div><p>This will declare a float array with 10 elements. Any material parameter
mapped with this array should be of FloatArray type and it&#x27;s size will
be assumed as 10 when the shader is generated.</p><p><strong>Material parameter driven size</strong>\
The size can be dynamic and driven by a material parameter. GLSL does
not support non constant values for array declaration so this material
parameter will be mapped to a define.\
<em>Example</em></p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">     float myArray[NumberOfElements]</span></div></div></div></div></div><p>This declares a float array with the size depending on the value of the
NumberOfElement material parameter.\
NumberOfElement <strong>HAS</strong> to be declared in the material definition as a
material parameter. It will be mapped to a define and used in the
shader.</p><p>::: {.note}
If this value change the shader will have to be recompiled, due to the
fact that it&#x27;s mapped to a define.
:::</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="shader-node-code"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#shader-node-code" title="Direct link to heading">#</a>Shader Node code</h1><p>The shader code associated with a Shader node is similar to any shader
code.\
The code for a Vertex shader node should be in a .vert file and the code
for a Fragment shader node should be in a .frag file. It has a
declarative part containing variable declaration, function declaration
and so on... And a main part that is embed in a &quot;void main(){} block.\
Input and output variables declared in the shader node definition can be
used <strong>without</strong> being declared in the shader code. ( they shouldn&#x27;t
even or you&#x27;ll have issues).\
Here is a the code of the LightMap.frag shader.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    color </span><span class="token operator" style="color:#393A34">*=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">texture2D</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">lightMap</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> texCoord</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div></div></div><p>Very simple, it&#x27;s just a texture fetch, but of course anything can be
done.\
<strong>Do not declare uniforms, attributes or varyings in a shader node
code</strong>, the Generator will handle this, just use the inputs and outputs
and optional local variables you may need.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="shader-node-declaration"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#shader-node-declaration" title="Direct link to heading">#</a>Shader Node declaration</h1><p>To create a shader we need to plug shader nodes to each other, but also
interact with built in glsl inputs and outputs. Shader nodes are
declared inside the Technique block. The vertex nodes are declared in
the VertexShaderNodes block and the fragment nodes are declared in the
FragmentShaderNodes block.\
Note that if the j3md has ember shader nodes definition (in a
ShaderNodesDefinitions block) it <strong>must</strong> be declared before the
VertexShaderNodes and FragmentShaderNodes blocks. Of course there can be
several ShaderNode declaration in those block.\
Here is how a ShaderNode declaration should look :</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token class-name">ShaderNode</span><span class="token plain"> </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">ShaderNodeName</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token class-name">Definition</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">DefinitionName</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">DefinitionPath</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">[</span><span class="token class-name">Condition</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">ActivationCondition</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token class-name">InputMapping</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">InputVariableName</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Swizzle</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">NameSpace</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">VarName</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Swizzle</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">MappingCondition</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">[</span><span class="token class-name">OutputMapping</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">NameSpace</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">VarName</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Swizzle</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">OutputVariableName</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Swizzle</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">MappingCondition</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div></div></div><ul><li><p>ShaderNode the shader node block</p><ul><li><strong>ShaderNodeName</strong> the name of this shader node, can be
anything, but has to be <strong>unique</strong> in the shader scope.</li></ul></li><li><p>Definition : a reference to the shader node definition.</p><ul><li><p><strong>DefinitionName</strong> : the name of the definition this Node use.
this definition can be declared in the same j3md or in its own
j3sn file.</p></li><li><p><strong>DefinitionPath</strong> : in case the definition is declared in it&#x27;s
own j3sn file, you have to set the path to this file here.</p></li></ul></li><li><p>Condition a condition that dictates if the node is active or not.</p><ul><li><strong>ActivationCondition</strong> : The condition for this node to be
used. Today we use Defines to use different blocks of code used
depending on the state of a Material Parameter. The condition
here use the exact same paradigm. A valid condition must be the
name of a material parameter or any combinations using logical
operators &quot;||,&quot;&amp;&amp;,&quot;! or grouping characters &quot;( and &quot;). The
generator will create the corresponding define and the shader
node code will be embed into and #ifdef statement.</li></ul></li></ul><p>For example, let&#x27;s say we have a Color and ColorMap material parameter,
this condition &quot;Color || ColorMap will generate this statement :</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">        #</span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">defined</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">COLOR</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">defined</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">COLORMAP</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        #endif</span></div></div></div></div></div><ul><li><p>InputMapping the wiring of the inputs of this node, coming from
previous node&#x27;s outputs or from built in glsl inputs.</p><ul><li><p><strong>InputVariableName</strong> : the name of the variable to map as
declared in the definition.</p></li><li><p><strong>Swizzle</strong> : Swizling for the preceding variable. More
information on glsl swizzling on this page
<a href="http://www.opengl.org/wiki/GLSL_Type">http://www.opengl.org/wiki/GLSL_Type</a>.</p></li><li><p><strong>NameSpace</strong> : The generator will use variable name space to
avoid collision between variable names. Name space can be one of
these values :</p><ul><li><p><strong>MatParam</strong> : the following variable is a Material
Parameter declared in the MaterialParameters block of the
materialDefinition.</p></li><li><p><strong>WorldParam</strong> : the following variable is a World Parameter
declared in the WorldParameters block of the current
technique block. World parameters can be one of those
declared in this file :
<a href="https://github.com/jMonkeyEngine/jmonkeyengine/blob/master/jme3-core/src/main/java/com/jme3/shader/UniformBinding.java">https://github.com/jMonkeyEngine/jmonkeyengine/blob/master/jme3-core/src/main/java/com/jme3/shader/UniformBinding.java</a></p></li><li><p><strong>Attr</strong> : the following variable is a shader attribute. It
can be one those declared in the Type enum of the
VertexBuffer class
<a href="https://github.com/jMonkeyEngine/jmonkeyengine/blob/master/jme3-core/src/main/java/com/jme3/scene/VertexBuffer.java">https://github.com/jMonkeyEngine/jmonkeyengine/blob/master/jme3-core/src/main/java/com/jme3/scene/VertexBuffer.java</a>.</p></li><li><p><strong>Global</strong> : the variable is a global variable to the
shader. Global variables will be assign at the end of the
shader to glsl built in outputs : gl_Position for the
vertex shader, or to one of the possible outputs of the
fragment shader (for example gl_FragColor). The global
variable can have what ever name pleases you, it will
assigned in the order they&#x27;ve been found in the declaration
to the shader output. <strong>Global variables can be inputs of a
shader node. Global variables are forced to be vec4 and are
defaulted to the value of the attribute inPosition in the
vertex shader and vec4(1.0)(opaque white color) in the
fragment shader</strong>.</p></li><li><p><strong>The name of a previous shader node</strong> : this must be
followed by and output variable of a the named shader node.
This is what allows one to plug outputs from a node to
inputs of another.</p></li></ul></li><li><p><strong>VarName</strong> : the name of the variable to assign to the input.
This variable must be known in name space declared before.</p></li><li><p><strong>MappingCondition</strong> : Follows the same rules as the activation
condition for the shaderNode, this mapping will be embed in a
#ifdef statement n the resulting shader.</p></li></ul></li><li><p>OutputMapping : This block is optional, as mapping of output will be
done in input mapping block of following shaderNodes, ecept if you
want to output a value to the Global output of the shader.</p><ul><li><p><strong>NameSpace</strong> : the name space of the output to assign, this can
only be &quot;Global here.</p></li><li><p><strong>VarName</strong> : the name of a global output (can be anything, just
be aware that 2 different names result in 2 different outputs).</p></li><li><p><strong>OutputVariable</strong> : Must be an output of the current node&#x27;s
definition.</p></li><li><p><strong>MappingCondition</strong> : Same as before.</p></li></ul></li></ul><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="complete-material-definition-and-shader-nodes-example"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#complete-material-definition-and-shader-nodes-example" title="Direct link to heading">#</a>Complete material definition and Shader Nodes example</h1><p>Here is an example of a very simple Material definition that just
displays a solid color (controlled by a material parameter) on a mesh.</p><p>::: {.important}
Shader Nodes only work if there is no shader declared in the technique.
If you want to bypass the Shader Nodes, you can put a VertexShader and a
FragmentShader statement in the technique and the shader nodes will be
ignored.
:::</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token class-name">MaterialDef</span><span class="token plain"> </span><span class="token class-name">Simple</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">MaterialParameters</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Color</span><span class="token plain"> </span><span class="token class-name">Color</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Technique</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">WorldParameters</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">WorldViewProjectionMatrix</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">VertexShaderNodes</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">ShaderNode</span><span class="token plain"> </span><span class="token class-name">CommonVert</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token class-name">Definition</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">CommonVert</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Common</span><span class="token operator" style="color:#393A34">/</span><span class="token class-name">MatDefs</span><span class="token operator" style="color:#393A34">/</span><span class="token class-name">ShaderNodes</span><span class="token operator" style="color:#393A34">/</span><span class="token class-name">Common</span><span class="token operator" style="color:#393A34">/</span><span class="token class-name">CommonVert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">j3sn</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token class-name">InputMappings</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    worldViewProjectionMatrix </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">WorldParam</span><span class="token punctuation" style="color:#393A34">.</span><span class="token class-name">WorldViewProjectionMatrix</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    modelPosition </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Global</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">position</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">xyz</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token class-name">OutputMappings</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token class-name">Global</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">position </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> projPosition</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">FragmentShaderNodes</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">ShaderNode</span><span class="token plain"> </span><span class="token class-name">ColorMult</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token class-name">Definition</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">ColorMult</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Common</span><span class="token operator" style="color:#393A34">/</span><span class="token class-name">MatDefs</span><span class="token operator" style="color:#393A34">/</span><span class="token class-name">ShaderNodes</span><span class="token operator" style="color:#393A34">/</span><span class="token class-name">Basic</span><span class="token operator" style="color:#393A34">/</span><span class="token class-name">ColorMult</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">j3sn</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token class-name">InputMappings</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    color1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">MatParam</span><span class="token punctuation" style="color:#393A34">.</span><span class="token class-name">Color</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    color2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Global</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">color</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token class-name">OutputMappings</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token class-name">Global</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">color </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> outColor</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div></div></div><p>This Material definition has one Default technique with 2 node
declarations.\
<strong>CommonVert Definition</strong>\
CommonVert is a vertex shader node that has commonly used input and
outputs of a vertex shader. It also computes the position of the vertex
in projection space.\
Here is the definition content
(Common/MatDefs/ShaderNodes/Common/CommonVert.j3sn) :</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token class-name">ShaderNodesDefinitions</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">ShaderNodeDefinition</span><span class="token plain"> </span><span class="token class-name">CommonVert</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Vertex</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Shader</span><span class="token plain"> GLSL100</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Common</span><span class="token operator" style="color:#393A34">/</span><span class="token class-name">MatDefs</span><span class="token operator" style="color:#393A34">/</span><span class="token class-name">ShaderNodes</span><span class="token operator" style="color:#393A34">/</span><span class="token class-name">Common</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">commonVert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">vert</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Documentation</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">This</span><span class="token plain"> </span><span class="token class-name">Node</span><span class="token plain"> is responsible </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> computing vertex position in projection space</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">It</span><span class="token plain"> also can pass texture coordinates </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> and vertexColor </span><span class="token keyword" style="color:#00009f">to</span><span class="token plain"> the frgment shader as varying </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">or inputs </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> glsl </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token number" style="color:#36acaa">1.3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token annotation punctuation" style="color:#393A34">@input</span><span class="token plain"> modelPosition the vertex position in model space </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">usually assigned </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token class-name">Attr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">inPosition or </span><span class="token class-name">Global</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">position</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token annotation punctuation" style="color:#393A34">@input</span><span class="token plain"> worldViewProjectionMatrix the </span><span class="token class-name">World</span><span class="token plain"> </span><span class="token class-name">View</span><span class="token plain"> </span><span class="token class-name">Projection</span><span class="token plain"> </span><span class="token class-name">Matrix</span><span class="token plain"> transforms model space </span><span class="token keyword" style="color:#00009f">to</span><span class="token plain"> projection space</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token annotation punctuation" style="color:#393A34">@input</span><span class="token plain"> texCoord1 </span><span class="token class-name">The</span><span class="token plain"> first texture coordinates of the vertex </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">usually assigned </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token class-name">Attr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">inTexCoord</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token annotation punctuation" style="color:#393A34">@input</span><span class="token plain"> texCoord2 </span><span class="token class-name">The</span><span class="token plain"> second texture coordinates of the vertex </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">usually assigned </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token class-name">Attr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">inTexCoord2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token annotation punctuation" style="color:#393A34">@input</span><span class="token plain"> vertColor </span><span class="token class-name">The</span><span class="token plain"> color of the vertex </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">usually assigned </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token class-name">Attr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">inColor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token annotation punctuation" style="color:#393A34">@output</span><span class="token plain"> projPosition </span><span class="token class-name">Position</span><span class="token plain"> of the vertex in projection space</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">usually assigned </span><span class="token keyword" style="color:#00009f">to</span><span class="token plain"> </span><span class="token class-name">Global</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">position</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token annotation punctuation" style="color:#393A34">@output</span><span class="token plain"> vec2 texCoord1 </span><span class="token class-name">The</span><span class="token plain"> first texture coordinates of the vertex </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">output as a varying</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token annotation punctuation" style="color:#393A34">@output</span><span class="token plain"> vec2 texCoord2 </span><span class="token class-name">The</span><span class="token plain"> second texture coordinates of the vertex </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">output as a varying</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token annotation punctuation" style="color:#393A34">@output</span><span class="token plain"> vec4 vertColor </span><span class="token class-name">The</span><span class="token plain"> color of the vertex </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">output as a varying</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Input</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            vec3 modelPosition</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            mat4 worldViewProjectionMatrix</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            vec2 texCoord1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            vec2 texCoord2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            vec4 vertColor</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Output</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            vec4 projPosition</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            vec2 texCoord1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            vec2 texCoord2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            vec4 vertColor</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Note that texCoord1/2 and vertColor are declared both as input and
output. The generator will use the same variables for them.</p></div></div><p>Here is the shader Node code (
Common/MatDefs/ShaderNodes/Common/commonVert.vert).</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    projPosition </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> worldViewProjectionMatrix </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">vec4</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">modelPosition</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div></div></div><p>As you can see all the inputs and outputs are not used. That&#x27;s because
most of them are attributes meant to be passed to the fragment shader as
varyings. All the wiring will be handled by the generator only if those
variables are used in an input or output mapping.</p><p><strong>CommonVert input mapping</strong>\
Here we have the most basic yet mandatory thing in a vertex shader,
computing vertex position in projection space. For this we have 2
mappings :</p><ul><li><p><strong>worldViewProjectionMatrix = WorldParam.WorldViewProjectionMatrix</strong>
: the input parameter worldViewProjectionMatrix is assigned with the
WorldViewProjectionMatrix World parameter declared in the
WorlParameters block of the technique.</p></li><li><p><strong>modelPosition = Global.position.xyz</strong> : the modelPosition
(understand the vertex position in the model coordinate space) is
assigned with the Global position variable.</p></li></ul><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>As mentioned before Global position is initialized with the attribute
inPosition, so this is equivalent to :</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">modelPosition </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Attr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">inPosition</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">xyz</span></div></div></div></div></div></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Also note the swizzle of the Global.position variable. ModelPosition is
a vec3 and GlobalPosition is a vec4 so we just take the first 3
components.</p></div></div><p><strong>CommonVert output mapping</strong>\</p><ul><li><strong>Global.position = projPosition</strong> : The result of the
multiplication of the worldViewProjectionMatrix and the
modelPosition is assigned to the Globale position.</li></ul><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>The Global.position variable will be assigned to the gl_Position glsl
built in output at the end of the shader.</p></div></div><p><strong>ColorMult Definition</strong>\
ColorMult is a very basic Shader Node that takes two colors as input and
multiply them. Here is the definition content
(Common/MatDefs/ShaderNodes/Basic/ColorMult.j3sn) :</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token class-name">ShaderNodeDefinitions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">ShaderNodeDefinition</span><span class="token plain"> </span><span class="token class-name">ColorMult</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Fragment</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Shader</span><span class="token plain"> GLSL100</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Common</span><span class="token operator" style="color:#393A34">/</span><span class="token class-name">MatDefs</span><span class="token operator" style="color:#393A34">/</span><span class="token class-name">ShaderNodes</span><span class="token operator" style="color:#393A34">/</span><span class="token class-name">Basic</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">colorMult</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">frag</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Documentation</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">Multiplies</span><span class="token plain"> two colors</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token annotation punctuation" style="color:#393A34">@input</span><span class="token plain"> color1 the first color</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token annotation punctuation" style="color:#393A34">@input</span><span class="token plain"> color2 the second color</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token annotation punctuation" style="color:#393A34">@output</span><span class="token plain"> outColor the resulting color</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Input</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            vec4 color1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            vec4 color2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Output</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            vec4 outColor</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div></div></div><p>Here is the shader Node code
(Common/MatDefs/ShaderNodes/Basic/colorMult.frag).</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    outColor </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> color1 </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> color2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div></div></div><p><strong>ColorMult input mapping</strong>\
All inputs are mapped here :</p><ul><li><p><strong>color1 = MatParam.Color</strong> : The first color is assigned to the
Color Material parameter declared in the MaterialParameter block of
the material definition.</p></li><li><p><strong>color2 = Global.color</strong> : The second color is assigned with the
Global color variable. this is defaulted to vec4(1.0) (opaque
white).</p></li></ul><p>::: {.note}
In a very complex material def this variable could already have been
assigned with a previous Shader Node output.
:::</p><p><strong>ColorMult output mapping</strong>\</p><ul><li><strong>Global.color = outColor</strong> : the resulting color is assigned to the
Global color variable.</li></ul><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Note that the Global.color variable will be assigned to gl_FragColor
(glsl \&lt; 1.5) or declared as a Global ouput of the shader (glsl &gt;=
1.5).</p></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Also note that in case several Global variables are declared, the
generator will assign them gl_FragData[i](glsl \&lt; 1.5) i being the
order the variable has been found in the material def. For glsl &gt;= 1.5
the veriable will just all be declared as shader output in the order
they&#x27;ve been found in the declaration.</p></div></div><p><strong>Generated shader code</strong></p><p>::: {.important}
Don&#x27;t take this code as carved in stone, the generated code can change
as optimization of the shader generator goes on.
:::</p><p>Vertex Shader (glsl 1.0)</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">uniform mat4 g_WorldViewProjectionMatrix</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">attribute vec4 inPosition</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        vec4 </span><span class="token class-name">Global_position</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> inPosition</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">//CommonVert : Begin</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        vec3 </span><span class="token class-name">CommonVert_modelPosition</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Global_position</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">xyz</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        vec4 </span><span class="token class-name">CommonVert_projPosition</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        vec2 </span><span class="token class-name">CommonVert_texCoord1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        vec2 </span><span class="token class-name">CommonVert_texCoord2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        vec4 </span><span class="token class-name">CommonVert_vertColor</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">CommonVert_projPosition</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> g_WorldViewProjectionMatrix </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">vec4</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">CommonVert_modelPosition</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Global_position</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">CommonVert_projPosition</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">//CommonVert : End</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        gl_Position </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Global_position</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div></div></div><p>All materials parameter, world parameters, attributes varying are
declared first. then for each shader node, the declarative part is
appended.\
For the main function, for each shader node, the input mappings are
declared and assigned, the output are declared.\
Then the variable names are replaced in the sahder node code with there
complete name (NameSpace_varName), material parameters are replaced in
the shader code as is.\
Then, the output are mapped.</p><p>As you can see texCoord1/2 and vertColor are declared but never used.
That&#x27;s because the generator is not aware of that. By default it will
declare all inputs in case they are used in the shaderNode code. Note
that most glsl compiler will optimize this when compiling the shader on
the GPU.</p><p>Fragment Shader (glsl 1.0)</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">uniform vec4 m_Color</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        vec4 </span><span class="token class-name">Global_color</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">vec4</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1.0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">//ColorMult : Begin</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        vec4 </span><span class="token class-name">ColorMult_color2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Global_color</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        vec4 </span><span class="token class-name">ColorMult_outColor</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">ColorMult_outColor</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> m_Color </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token class-name">ColorMult_color2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Global_color</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">ColorMult_outColor</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">//ColorMult : End</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        gl_FragColor </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Global_color</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div></div></div><p>Same as for the Vertex shader. Note that the color1 is not declared,
because it&#x27;s directly replaced by the material parameter.</p><p>::: {.important}
As a rule of thumb you should not assign a value to an input. Inputs are
likely to be material paramters or outputs from other shaders and
modifying them may cause unexpected behavior, even failure in your
resulting shader.
:::</p><p>For more explanations and design decisions please refer to the spec here
<a href="https://docs.google.com/document/d/1S6xO3d1TBz0xcKe_MPTqY9V-QI59AKdg1OGy3U-HeVY/edit?usp=sharing">https://docs.google.com/document/d/1S6xO3d1TBz0xcKe_MPTqY9V-QI59AKdg1OGy3U-HeVY/edit?usp=sharing</a>.</p><p>Thank you for the brave ones that came through all this reading. I&#x27;m not
gonna offer you a prize in exchange of a password, because we ran out of
JME thongs...</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/8keep/wikidemo/edit/master/docs/jme3/advanced/jme3_shadernodes.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#example" class="contents__link">Example</a></li><li><a href="#declare-an-array" class="contents__link">Declare an array</a></li></ul></div></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="text--center"><div>Copyright  2020 jMonkeyEngine.</div></div></div></footer>
</div>

<script src="/wikidemostyles.08ff7081.js"></script>

<script src="/wikidemoruntime~main.aab3cf1b.js"></script>

<script src="/wikidemomain.53cb7c94.js"></script>

<script src="/wikidemo1.e501629b.js"></script>

<script src="/wikidemo2.c824d386.js"></script>

<script src="/wikidemo302.1d1a2997.js"></script>

<script src="/wikidemo394d525a.30c299b8.js"></script>

<script src="/wikidemo17896441.d065d5f5.js"></script>

<script src="/wikidemoc394a4b7.005237dd.js"></script>


</body>
</html>