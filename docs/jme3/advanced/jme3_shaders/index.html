<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.50">
<script src="/js/dark_default.js"></script>

<title data-react-helmet="true">jme3_shaders | jMonkeyEngine Documentation</title>

<meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="jme3_shaders | jMonkeyEngine Documentation"><meta data-react-helmet="true" name="description" content="Shaders Basics"><meta data-react-helmet="true" property="og:description" content="Shaders Basics"><meta data-react-helmet="true" property="og:url" content="https://8keep.github.io/wikidemo/docs/jme3/advanced/jme3_shaders">

<link data-react-helmet="true" rel="shortcut icon" href="/wikidemo/img/favicon.ico">


<link rel="stylesheet" href="/wikidemo/styles.7d008dc0.css">


<link rel="preload" href="/wikidemo/styles.08ff7081.js" as="script">

<link rel="preload" href="/wikidemo/runtime~main.7418f8ca.js" as="script">

<link rel="preload" href="/wikidemo/main.1b6aa70f.js" as="script">

<link rel="preload" href="/wikidemo/1.e501629b.js" as="script">

<link rel="preload" href="/wikidemo/2.c824d386.js" as="script">

<link rel="preload" href="/wikidemo/302.1d1a2997.js" as="script">

<link rel="preload" href="/wikidemo/394d525a.30c299b8.js" as="script">

<link rel="preload" href="/wikidemo/17896441.d065d5f5.js" as="script">

<link rel="preload" href="/wikidemo/081d45da.99e0d27c.js" as="script">

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a aria-current="page" class="navbar__brand active" href="/wikidemo/"><img class="navbar__logo" src="/wikidemo/img/iconx128.png" alt="JmonkeyEngine"><strong class="navbar__title"></strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/wikidemo/docs/documentation">Docs</a></div><div class="navbar__items navbar__items--right"><a target="_blank" rel="noopener noreferrer" href="https://github.com/8keep/wikidemo" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a aria-current="page" class="navbar__brand active" href="/wikidemo/"><img class="navbar__logo" src="/wikidemo/img/iconx128.png" alt="JmonkeyEngine"><strong class="navbar__title"></strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/wikidemo/docs/documentation">Docs</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://github.com/8keep/wikidemo" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><main class="docMainContainer_FFX1"><div class="padding-vert--lg"><div class="container"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">jme3_shaders</h1></header><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="shaders-basics"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#shaders-basics" title="Direct link to heading">#</a>Shaders Basics</h1><p>Shaders are sets of instructions that are executed on the GPU. They are
used to take advantage of hardware acceleration available on the GPU for
rendering purposes.</p><p>This paper only covers Vertex and Fragment shaders because they are the
only ones supported by JME3 for the moment. Be aware that there are some
other types of shaders (geometry, tessellation,...).</p><p>There are multiple frequently used languages that you may encounter to
code shaders but as JME3 is based on OpenGL, shaders in JME use GLSL and
any example in this paper will be written in GLSL.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="how-does-it-work"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#how-does-it-work" title="Direct link to heading">#</a>How Does it work?</h2><p>To keep it Simple: The Vertex shader is executed once for each vertex in
the view, then the Fragment shader (also called the Pixel shader) is
executed once for each pixel on the screen.</p><p>The main purpose of the Vertex shader is to compute the screen
coordinate of a vertex (where this vertex will be displayed on screen)
while the main purpose of the Fragment shader is to compute the color of
a pixel.</p><p>This is a very simplified graphic to describe the call stack:</p><p><img src="/images/jme3/advanced/jme3andshaders.png" alt="jme3andshaders.png"></p><p>The main program sends mesh data to the vertex shader (vertex position
in object space, normals, tangents, etc..). The vertex shader computes
the screen position of the vertex and sends it to the Fragment shader.
The fragment shader computes the color, and the result is displayed on
screen or in a texture.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="variables-scope"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#variables-scope" title="Direct link to heading">#</a>Variables scope</h2><p>There are different types of scope for variables in a shader:</p><ul><li><p>uniform: User defined variables that are passed by the main program
to the vertex and fragment shader, these variables are global for a
given execution of a shader.</p></li><li><p>attribute: Per-vertex variables passed by the engine to the shader,
like position, normal, etc (Mesh data in the graphic)</p></li><li><p>varying: Variables passed from the vertex shader to the fragment
shader.</p></li></ul><p>There is a large panel of variable types to be used, for more
information about it I recommend reading the GLSL specification
<a href="http://www.opengl.org/registry/doc/GLSLangSpec.Full.1.20.8.pdf">here</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="spaces-and-matrices"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#spaces-and-matrices" title="Direct link to heading">#</a>Spaces and Matrices</h2><p>To understand the coming example you must know about the different
spaces in 3D computer graphics, and the matrices used to translate
coordinate from one space to another.</p><p><img src="/images/jme3/advanced/jme3andshaders-1.png" alt="jme3andshaders-1.png"></p><p>The engine passes the object space coordinates to the vertex shader. We
need to compute its position in projection space. To do that we
transform the object space position by the WorldViewProjectionMatrix,
which is a combination of the World, View, Projection matrices (who
would have guessed?).</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="simple-example-rendering-a-solid-color-on-an-object"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#simple-example-rendering-a-solid-color-on-an-object" title="Direct link to heading">#</a>Simple example: rendering a solid color on an object</h2><p>Here is the simplest application to shaders, rendering a solid color.</p><p>Vertex Shader:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">//the global uniform World view projection matrix</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//(more on global uniforms below)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">uniform mat4 g_WorldViewProjectionMatrix</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//The attribute inPosition is the Object space position of the vertex</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">attribute vec3 inPosition</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//Transformation of the object space coordinate to projection space</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//coordinates.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//- gl_Position is the standard GLSL variable holding projection space</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//position. It must be filled in the vertex shader</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//- To convert position we multiply the worldViewProjectionMatrix by</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//by the position vector.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//The multiplication must be done in this order.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    gl_Position </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> g_WorldViewProjectionMatrix </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">vec4</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">inPosition</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div></div></div><p>Fragment Shader :</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//returning the color of the pixel (here solid blue)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//- gl_FragColor is the standard GLSL variable that holds the pixel</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//color. It must be filled in the Fragment Shader.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    gl_FragColor </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">vec4</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div></div></div><p>For example applying this shader to a sphere would render a solid blue
sphere on screen.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="how-to-use-shaders-in-jme3"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#how-to-use-shaders-in-jme3" title="Direct link to heading">#</a>How to use shaders in JME3</h1><p>You probably heard that JME3 is &quot;shader oriented&quot;, but what does that
mean?\
Usually, to use shaders you must create a program. This program
specifies the vertex shader and the fragment shader to use. JME3
encloses this in the material system. Every material in JME3 uses
shaders.</p><p>For example let&#x27;s have a look at the SolidColor.j3md file :</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token class-name">MaterialDef</span><span class="token plain"> </span><span class="token class-name">Solid</span><span class="token plain"> </span><span class="token class-name">Color</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//This is the complete list of user defined uniforms to be used in the</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//shaders</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">MaterialParameters</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Vector4</span><span class="token plain"> </span><span class="token class-name">Color</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Technique</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">//This is where the vertex and fragment shader files are</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">//specified</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">VertexShader</span><span class="token plain"> GLSL100</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">   </span><span class="token class-name">Common</span><span class="token operator" style="color:#393A34">/</span><span class="token class-name">MatDefs</span><span class="token operator" style="color:#393A34">/</span><span class="token class-name">Misc</span><span class="token operator" style="color:#393A34">/</span><span class="token class-name">SolidColor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">vert</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">FragmentShader</span><span class="token plain"> GLSL100</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Common</span><span class="token operator" style="color:#393A34">/</span><span class="token class-name">MatDefs</span><span class="token operator" style="color:#393A34">/</span><span class="token class-name">Misc</span><span class="token operator" style="color:#393A34">/</span><span class="token class-name">SolidColor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">frag</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">//This is where you specify which global uniform you need for your</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">//shaders</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">WorldParameters</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">WorldViewProjectionMatrix</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Technique</span><span class="token plain"> </span><span class="token class-name">FixedFunc</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div></div></div><p>For more information on JME3 material system, I suggest you read
<a href="https://hub.jmonkeyengine.org/t/jmonkeyengine3-material-system-full-explanation/12947">jMonkeyEngine3 material system - full
explanation</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="jme3-global-uniforms"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#jme3-global-uniforms" title="Direct link to heading">#</a>JME3 Global uniforms</h2><p>JME3 can expose pre-computed global uniforms to your shaders. You must
specify the ones that are required for your shader in the
WorldParameter&#x27;s section of the material definition file (.j3md).</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>In the shader, the uniform names will be prefixed by a &quot;g_&quot;.</p></div></div><p>In the example above, WorldViewProjectionMatrix is declared as uniform
mat4 g_WorldViewProjectionMatrix in the shader.</p><p>The complete list of global uniforms that can be used in JME3 can be
found in
<a href="https://github.com/jMonkeyEngine/jmonkeyengine/blob/master/jme3-core/src/main/java/com/jme3/shader/UniformBinding.java">UniformBinding.java</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="jme3-lighting-global-uniforms"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#jme3-lighting-global-uniforms" title="Direct link to heading">#</a>JME3 Lighting Global uniforms</h2><p>JME3 uses some global uniforms for lighting:</p><ul><li><p>g_LightDirection (vec4): the direction of the light</p><ul><li>use for SpotLight: x,y,z contain the world direction vector of
the light, the w component contains the spotlight angle cosine</li></ul></li><li><p>g_LightColor (vec4): the color of the light</p></li><li><p>g_LightPosition: the position of the light</p><ul><li><p>use for SpotLight: x,y,z contain the world position of the
light, the w component contains 1/lightRange</p></li><li><p>use for PointLight: x,y,z contain the world position of the
light, the w component contains 1/lightRadius</p></li><li><p>use for DirectionalLight: strangely enough it&#x27;s used for the
direction of the light...this might change though. The fourth
component contains -1 and it&#x27;s used in the lighting shader to
know if it&#x27;s a directionalLight or not.</p></li></ul></li><li><p>g_AmbientLightColor: the color of the ambient light.</p></li></ul><p>These uniforms are passed to the shader without having to declare them
in the j3md file, but you have to specify in the technique definition &quot;
LightMode MultiPass see lighting.j3md for more information.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="jme3-attributes"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#jme3-attributes" title="Direct link to heading">#</a>JME3 attributes</h2><p>Those are different attributes that are always passed to your shader.</p><p>You can find a complete list of those attribute in the Type enum of the
VertexBuffer in
<a href="https://github.com/jMonkeyEngine/jmonkeyengine/blob/master/jme3-core/src/main/java/com/jme3/scene/VertexBuffer.java">VertexBuffer.java</a>.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>In the shader the attributes names will be prefixed by an &quot;in&quot;.</p></div></div><p>When the enumeration lists some usual types for each attribute (for
example texCoord specifies two floats) then that is the format expected
by all standard JME3 shaders that use that attribute. When writing your
own shaders though you can use alternative formats such as placing three
floats in texCoord simply by declaring the attribute as vec3 in the
shader and passing 3 as the component count into the mesh setBuffer
call.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="users-uniforms"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#users-uniforms" title="Direct link to heading">#</a>User&#x27;s uniforms</h2><p>At some point when making your own shader you&#x27;ll need to pass your own
uniforms.</p><p>Any uniform has to be declared in the material definition file (.j3md)
in the &quot;MaterialParameters section.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">MaterialParameters</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Vector4</span><span class="token plain"> </span><span class="token class-name">Color</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Texture2D</span><span class="token plain"> </span><span class="token class-name">ColorMap</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span></div></div></div></div></div><p>You can also pass some define to your vertex/fragment programs to know
if an uniform as been declared.</p><p>You simply add it in the Defines section of your Technique in the
definition file.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Defines</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        COLORMAP </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">ColorMap</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span></div></div></div></div></div><p>For integer and floating point parameters, the define will contain the
value that was set.</p><p>For all other types of parameters, the value 1 is defined.</p><p>If no value is set for that parameter, the define is not declared in the
shader.</p><p>Those material parameters will be sent from the engine to the shader as
follows, there are setXXXX methods for any type of uniform you want to
pass.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">   material</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setColor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Color&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ColorRGBA</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1.0f</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0f</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0f</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0f</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// red color</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">   material</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setTexture</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;ColorMap&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> myTexture</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// bind myTexture for that sampler uniform</span></div></div></div></div></div><p>To use this uniform in the shader, you need to declare it in the .frag
or .vert files (depending on where you need it). You can make use of the
defines here and later in the code: <strong>Note that the &quot;m_ prefix
specifies that the uniform is a material parameter.</strong></p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">   uniform vec4 m_Color</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">   #ifdef COLORMAP</span></div><div class="token-line" style="color:#393A34"><span class="token plain">     uniform sampler2D m_ColorMap</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">   #endif</span></div></div></div></div></div><p>The uniforms will be populated at runtime with the value you sent.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="example-adding-color-keying-to-the-lightingj3md-material-definition"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#example-adding-color-keying-to-the-lightingj3md-material-definition" title="Direct link to heading">#</a>Example: Adding Color Keying to the Lighting.j3md Material Definition</h2><p>Color Keying is useful in games involving many players. It consists of
adding some player-specific color on models textures. The easiest way of
doing this is to use a keyMap which will contain the amount of color to
add in its alpha channel.</p><p>Here I will use this color map:\
<img src="http://wstaw.org/m/2011/10/24/plasma-desktopxB2787.jpg" alt="&lt;http://wstaw.org/m/2011/10/24/plasma-desktopxB2787.jpg&gt;">\
to blend color on this texture:\
<img src="http://wstaw.org/m/2011/10/24/plasma-desktopbq2787.jpg" alt="&lt;http://wstaw.org/m/2011/10/24/plasma-desktopbq2787.jpg&gt;"></p><p>We need to pass 2 new parameters to the Lighting.j3md definition,
MaterialParameters section:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Keying Map</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Texture2D</span><span class="token plain"> </span><span class="token class-name">KeyMap</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Key Color</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Color</span><span class="token plain"> </span><span class="token class-name">KeyColor</span></div></div></div></div></div><p>Below, add a new Define in the main Technique section:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">KEYMAP </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">KeyMap</span></div></div></div></div></div><p>In the Lighting.frag file, define the new uniforms:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">#ifdef KEYMAP</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  uniform sampler2D m_KeyMap</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  uniform vec4 m_KeyColor</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">#endif</span></div></div></div></div></div><p>Further, when obtaining the diffuseColor from the DiffuseMap texture,
check if we need to blend it:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">#ifdef KEYMAP</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  vec4 keyColor </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">texture2D</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">m_KeyMap</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> newTexCoord</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  diffuseColor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rgb </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1.0</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">keyColor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> diffuseColor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rgb </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> keyColor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">a </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> m_KeyColor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rgb</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">#endif</span></div></div></div></div></div><p>This way, a transparent pixel in the KeyMap texture doesn&#x27;t modify the
color. A black pixel replaces it for the m_KeyColor and values in
between are blended.</p><p>A result preview can be seen here:</p><p><img src="http://wstaw.org/m/2011/10/24/plasma-desktopuV2787.jpg"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="step-by-step"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#step-by-step" title="Direct link to heading">#</a>Step by step</h2><ul><li><p>Create a vertex shader (.vert) file</p></li><li><p>Create a fragment shader (.frag) file</p></li><li><p>Create a material definition (j3md) file specifying the user defined
uniforms, path to the shaders and the global uniforms to use</p></li><li><p>In your initSimpleApplication, create a material using this
definition, apply it to a geometry</p></li><li><p>That&#x27;s it!!</p></li></ul><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// A cube</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Box</span><span class="token plain"> box</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Box</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Vector3f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ZERO</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1f</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1f</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1f</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Geometry</span><span class="token plain"> cube </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Geometry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;box&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> box</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Material</span><span class="token plain"> mat </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Material</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">assetManager</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;Path/To/My/materialDef.j3md&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    cube</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setMaterial</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mat</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    rootNode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">attachChild</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cube</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="jme3-and-opengl-3--4-compatibility"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#jme3-and-opengl-3--4-compatibility" title="Direct link to heading">#</a>JME3 and OpenGL 3 &amp; 4 compatibility</h2><p>GLSL 1.0 to 1.2 comes with built in attributes and uniforms (ie,
gl_Vertex, gl_ModelViewMatrix, etc...). Those attributes are
deprecated since GLSL 1.3 (opengl 3), hence JME3 global uniforms and
attributes.</p><p>Here is a list of deprecated attributes and their equivalent in JME3.</p><p>+-----------------------------------+-----------------------------------+
| GLSL 1.2 attributes               | JME3 equivalent                   |
+===================================+===================================+
| gl_Vertex                        | inPosition                        |
+-----------------------------------+-----------------------------------+
| gl_Normal                        | inNormal                          |
+-----------------------------------+-----------------------------------+
| gl_Color                         | inColor                           |
+-----------------------------------+-----------------------------------+
| gl_MultiTexCoord0                | inTexCoord                        |
+-----------------------------------+-----------------------------------+
| gl_ModelViewMatrix               | g_WorldViewMatrix                |
+-----------------------------------+-----------------------------------+
| gl_ProjectionMatrix              | g_ProjectionMatrix               |
+-----------------------------------+-----------------------------------+
| gl_ModelViewProjectionMatrix     | g_WorldViewProjectionMatrix      |
+-----------------------------------+-----------------------------------+
| gl_NormalMatrix                  | g_NormalMatrix                   |
+-----------------------------------+-----------------------------------+</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="useful-links"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#useful-links" title="Direct link to heading">#</a>Useful links</h2><p><a href="http://www.eng.utah.edu/~cs5610/lectures/GLSL-ATI-Intro.pdf">http://www.eng.utah.edu/~cs5610/lectures/GLSL-ATI-Intro.pdf</a></p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/8keep/wikidemo/edit/master/docs/jme3/advanced/jme3_shaders.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#how-does-it-work" class="contents__link">How Does it work?</a></li><li><a href="#variables-scope" class="contents__link">Variables scope</a></li><li><a href="#spaces-and-matrices" class="contents__link">Spaces and Matrices</a></li><li><a href="#simple-example-rendering-a-solid-color-on-an-object" class="contents__link">Simple example: rendering a solid color on an object</a></li><li><a href="#jme3-global-uniforms" class="contents__link">JME3 Global uniforms</a></li><li><a href="#jme3-lighting-global-uniforms" class="contents__link">JME3 Lighting Global uniforms</a></li><li><a href="#jme3-attributes" class="contents__link">JME3 attributes</a></li><li><a href="#users-uniforms" class="contents__link">User&#39;s uniforms</a></li><li><a href="#example-adding-color-keying-to-the-lightingj3md-material-definition" class="contents__link">Example: Adding Color Keying to the Lighting.j3md Material Definition</a></li><li><a href="#step-by-step" class="contents__link">Step by step</a></li><li><a href="#jme3-and-opengl-3--4-compatibility" class="contents__link">JME3 and OpenGL 3 &amp; 4 compatibility</a></li><li><a href="#useful-links" class="contents__link">Useful links</a></li></ul></div></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="text--center"><div>Copyright © 2020 jMonkeyEngine.</div></div></div></footer>
</div>

<script src="/wikidemo/styles.08ff7081.js"></script>

<script src="/wikidemo/runtime~main.7418f8ca.js"></script>

<script src="/wikidemo/main.1b6aa70f.js"></script>

<script src="/wikidemo/1.e501629b.js"></script>

<script src="/wikidemo/2.c824d386.js"></script>

<script src="/wikidemo/302.1d1a2997.js"></script>

<script src="/wikidemo/394d525a.30c299b8.js"></script>

<script src="/wikidemo/17896441.d065d5f5.js"></script>

<script src="/wikidemo/081d45da.99e0d27c.js"></script>


</body>
</html>