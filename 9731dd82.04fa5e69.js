(window.webpackJsonp=window.webpackJsonp||[]).push([[174],{313:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return r})),n.d(t,"metadata",(function(){return l})),n.d(t,"rightToc",(function(){return c})),n.d(t,"default",(function(){return p}));var a=n(1),o=n(9),i=(n(0),n(441)),r={},l={id:"jme3/advanced/hinges_and_joints",title:"hinges_and_joints",description:"The jMonkeyEngine3 has built-in support for [jBullet",source:"@site/docs/jme3/advanced/hinges_and_joints.md",permalink:"/wikidemo/docs/jme3/advanced/hinges_and_joints",editUrl:"https://github.com/8keep/wikidemo/edit/master/docs/jme3/advanced/hinges_and_joints.md"},c=[],s={rightToc:c};function p(e){var t=e.components,n=Object(o.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},s,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,"The jMonkeyEngine3 has built-in support for ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"http://jbullet.advel.cz"}),"jBullet\nphysics")," via the ",Object(i.b)("inlineCode",{parentName:"p"},"com.jme3.bullet")," package."),Object(i.b)("p",null,"Game Physics are not only employed to calculate collisions, but they can\nalso simulate hinges and joints. Think of pulley chains, shaky rope\nbridges, swinging pendulums, or (trap)door and chest hinges. Physics are\na great addition to e.g. an action or puzzle game."),Object(i.b)("p",null,"In this example, we will create a pendulum. The joint is the (invisible)\nconnection between the pendulum body and the hook. You will see that you\ncan use what you learn from the simple pendulum and apply it to other\njoint/hinge objects (rope bridges, etc)."),Object(i.b)("h1",{id:"sample-code"},"Sample Code"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://github.com/jMonkeyEngine/jmonkeyengine/blob/master/jme3-examples/src/main/java/jme3test/bullet/TestPhysicsHingeJoint.java"}),"TestPhysicsHingeJoint.java"))),Object(i.b)("h1",{id:"overview-of-this-physics-application"},"Overview of this Physics Application"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Create a SimpleApplication with a\n",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"../../jme3/advanced/physics"}),"BulletAppState")),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"This gives us a PhysicsSpace for PhysicsControls"))),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"For the pendulum, we use a Spatial with a PhysicsControl, and we\napply physical forces to them."),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"The parts of the \"pendulum are Physics Control'ed Spatials with\nCollision Shapes.")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"We create a fixed ",Object(i.b)("inlineCode",{parentName:"p"},"hookNode")," and a dynamic ",Object(i.b)("inlineCode",{parentName:"p"},"pendulumNode"),".")))),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},'We can "crank the handle and rotate the joint like a hinge, or we\ncan let loose and expose the joints freely to gravity.'),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"For physical forces we will use the method\n",Object(i.b)("inlineCode",{parentName:"li"},"joint.enableMotor();"))))),Object(i.b)("h1",{id:"creating-a-fixed-node"},"Creating a Fixed Node"),Object(i.b)("p",null,"The hookNode is the fixed point from which the pendulum hangs. It has no\nmass."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),"Node hookNode=PhysicsTestHelper.createPhysicsTestNode(\n    assetManager, new BoxCollisionShape(new Vector3f( .1f, .1f, .1f)),0);\nhookNode.getControl(RigidBodyControl.class).setPhysicsLocation(new Vector3f(0f,0,0f));\n\nrootNode.attachChild(hookNode);\ngetPhysicsSpace().add(hookNode);\n")),Object(i.b)("p",null,"For a rope bridge, there would be two fixed nodes where the bridge is\nattached to the mountainside."),Object(i.b)("h1",{id:"creating-a-dynamic-node"},"Creating a Dynamic Node"),Object(i.b)("p",null,"The pendulumNode is the dynamic part of the construction. It has a mass."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),"Node pendulumNode=PhysicsTestHelper.createPhysicsTestNode(\n    assetManager, new BoxCollisionShape(new Vector3f( .3f, .3f, .3f)),1);\npendulumNode.getControl(RigidBodyControl.class).setPhysicsLocation(new Vector3f(0f,-1,0f));\nrootNode.attachChild(pendulumNode);\ngetPhysicsSpace().add(pendulumNode);\n")),Object(i.b)("p",null,"For a rope bridge, each set of planks would be one dynamic node."),Object(i.b)("h1",{id:"understanding-dof-joints-and-hinges"},"Understanding DOF, Joints, and Hinges"),Object(i.b)("p",null,"A PhysicsHingeJoint is an invisible connection between two nodes -- here\nbetween the pendulum body and the hook. Why are hinges and joints\nrepresented by the same class? Hinges and joints have something in\ncommon: They constrain the ",Object(i.b)("em",{parentName:"p"},"mechanical degree of freedom")," (DOF) of\nanother object."),Object(i.b)("p",null,'Consider a free falling, "unchained object in physical 3D space: It has\n6 DOFs:'),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"It translates along 3 axes")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"It rotates around 3 axes"))),Object(i.b)("p",null,"Now consider some examples of objects with joints:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"An individual chain link is free to spin and move around, but joined\ninto a chain, the link's movement is restricted to stay with the\nsurrounding links.")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"A person's arm can rotate around some axes, but not around others.\nThe shoulder joint allows one and restricts the other.")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"A door hinge is one of the most restricted types of joint: It can\nonly rotate around one axis."))),Object(i.b)("p",null,"You'll understand that, when creating any type of joint, it is important\nto correctly specify the DOFs that the joint restricts, and the DOFs\nthat the joint allows. For the typical DOF of a\n",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"../../jme3/advanced/ragdoll"}),"ragDoll")," character's limbs, jME even\noffers a special joint, ",Object(i.b)("inlineCode",{parentName:"p"},"ConeJoint"),"."),Object(i.b)("h1",{id:"creating-the-joint"},"Creating the Joint"),Object(i.b)("p",null,"You create the HingeJoint after you have created the nodes that are to\nbe chained together. In the code snippet you see that the HingeJoint\nconstructor requires the two node objects. You also have to specify axes\nand pivots -- they are the degrees of freedom that you just heard about."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),"private HingeJoint joint;\n...\n  public void simpleInitApp() {\n    ...\n    // hookNode and pendulumNode are created here...\n    ...\n\n    joint=new HingeJoint(hookNode.getControl(RigidBodyControl.class), // A\n                     pendulumNode.getControl(RigidBodyControl.class), // B\n                     new Vector3f(0f, 0f, 0f),  // pivot point local to A\n                     new Vector3f(0f, 1f, 0f),  // pivot point local to B\n                     Vector3f.UNIT_Z,           // DoF Axis of A (Z axis)\n                     Vector3f.UNIT_Z  );        // DoF Axis of B (Z axis)\n")),Object(i.b)("p",null,"The pivot point's position will be at ",Object(i.b)("inlineCode",{parentName:"p"},"(0,0,0)")," in the global 3D space.\nIn A's local space that is at ",Object(i.b)("inlineCode",{parentName:"p"},"(0,0,0)")," and in B's local space (remember\nB's position was set to ",Object(i.b)("inlineCode",{parentName:"p"},"(0,-1,0)"),") that is at ",Object(i.b)("inlineCode",{parentName:"p"},"(0,1,0)"),"."),Object(i.b)("p",null,"Specify the following parameters for each joint:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"PhysicsControl A and B -- the two nodes that are to be joined")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Vector3f pivot A and pivot B -- coordinates of the attachment point\nrelative to A and B"),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"The points typically lie on the surface of the PhysicsControl's\nSpatials, rarely in the middle."))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Vector3f axisA and axisB -- around which axes each node is allowed\nto spin."),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"In our example, we constrain the pendulum to swing only along\nthe Z axis.")))),Object(i.b)("p",null,"Remember to add all joint objects to the physicsSpace, just like you\nwould do with any physical objects."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),"bulletAppState.getPhysicsSpace().add(joint);\n")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Tip:")," If you want the joint to be visible, attach a geometry to the\ndynamic node, and translate it to its start position."),Object(i.b)("h1",{id:"apply-physical-forces"},"Apply Physical Forces"),Object(i.b)("p",null,'You can apply forces to dynamic nodes (the ones that have a mass), and\nsee how other joined ("chained) objects are dragged along.'),Object(i.b)("p",null,"Alternatively, you can also apply forces to the joint itself. In a game,\nyou may want to spin an automatic revolving door, or slam a door closed\nin a spooky way, or dramatically open the lid of a treasure chest."),Object(i.b)("p",null,"The method to call on the joint is ",Object(i.b)("inlineCode",{parentName:"p"},"enableMotor()"),"."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),"joint.enableMotor(true, 1, .1f);\njoint.enableMotor(true, -1, .1f);\n")),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Switch the motor on by supplying ",Object(i.b)("inlineCode",{parentName:"p"},"true"))),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Specify the velocity with which the joint should rotate around the\nspecified axis."),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"Use positive and negative numbers to change direction."))),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Specify the impulse for this motor. Heavier masses need a bigger\nimpulse to be moved."))),Object(i.b)("p",null,"When you disable the motor, the chained nodes are exposed to gravity\nagain:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),"joint.enableMotor(false, 0, 0);\n")))}p.isMDXComponent=!0},441:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return u}));var a=n(0),o=n.n(a);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=o.a.createContext({}),p=function(e){var t=o.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l({},t,{},e)),n},b=function(e){var t=p(e.components);return o.a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},h=Object(a.forwardRef)((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,r=e.parentName,s=c(e,["components","mdxType","originalType","parentName"]),b=p(n),h=a,u=b["".concat(r,".").concat(h)]||b[h]||d[h]||i;return n?o.a.createElement(u,l({ref:t},s,{components:n})):o.a.createElement(u,l({ref:t},s))}));function u(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,r=new Array(i);r[0]=h;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:a,r[1]=l;for(var s=2;s<i;s++)r[s]=n[s];return o.a.createElement.apply(null,r)}return o.a.createElement.apply(null,n)}h.displayName="MDXCreateElement"}}]);